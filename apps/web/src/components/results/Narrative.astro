---

---

<div class="card-elevated mb-8" id="narrative-section">
  <div class="flex items-center justify-between mb-4">
    <h3 class="text-lg font-semibold text-primary-900">Narasi Hasil Analisis</h3>
    <div class="flex gap-2">
      <button id="btn-show-formula" class="btn-secondary text-sm py-2">
        <svg class="w-4 h-4" fill="none" stroke="currentColor" viewBox="0 0 24 24">
          <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 7h6m0 10v-3m-3 3h.01M9 17h.01M9 14h.01M12 14h.01M15 11h.01M12 11h.01M9 11h.01M7 21h10a2 2 0 002-2V5a2 2 0 00-2-2H7a2 2 0 00-2 2v14a2 2 0 002 2z" />
        </svg>
        Lihat Rumus
      </button>
      <button id="btn-copy-narrative" class="btn-secondary text-sm py-2">
        <svg class="w-4 h-4" fill="none" stroke="currentColor" viewBox="0 0 24 24">
          <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M8 16H6a2 2 0 01-2-2V6a2 2 0 012-2h8a2 2 0 012 2v2m-6 12h8a2 2 0 002-2v-8a2 2 0 00-2-2h-8a2 2 0 00-2 2v8a2 2 0 002 2z" />
        </svg>
        Salin Narasi
      </button>
    </div>
  </div>
  
  <div class="alert-info mb-4">
    <svg class="w-5 h-5 shrink-0" fill="currentColor" viewBox="0 0 20 20">
      <path fill-rule="evenodd" d="M18 10a8 8 0 11-16 0 8 8 0 0116 0zm-7-4a1 1 0 11-2 0 1 1 0 012 0zM9 9a1 1 0 000 2v3a1 1 0 001 1h1a1 1 0 100-2v-3a1 1 0 00-1-1H9z" clip-rule="evenodd" />
    </svg>
    <span>Narasi berikut dapat langsung dikutip dalam laporan atau jurnal akademik.</span>
  </div>
  
  <div id="narrative-content" class="prose prose-sm max-w-none text-secondary-700 space-y-4">
  </div>
  
  <div class="text-center mt-4" id="show-more-narrative-container" style="display: none;">
    <button id="btn-show-more-narrative" class="text-sm text-primary-600 hover:text-primary-800 underline">
      Tampilkan Semua Narasi
    </button>
  </div>
</div>

<script>
  document.addEventListener('DOMContentLoaded', () => {
    const copyBtn = document.getElementById('btn-copy-narrative');
    const narrativeContent = document.getElementById('narrative-content');
    const showFormulaBtn = document.getElementById('btn-show-formula');
    
    copyBtn?.addEventListener('click', async () => {
      if (narrativeContent) {
        const text = narrativeContent.innerText;
        try {
          await navigator.clipboard.writeText(text);
          const originalText = copyBtn.innerHTML;
          copyBtn.innerHTML = '<svg class="w-4 h-4" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M5 13l4 4L19 7" /></svg> Tersalin!';
          setTimeout(() => {
            copyBtn.innerHTML = originalText;
          }, 2000);
        } catch (err) {
          alert('Gagal menyalin narasi');
        }
      }
    });

    showFormulaBtn?.addEventListener('click', () => {
      const formulaSection = document.getElementById('formula-section');
      const formulaContent = document.getElementById('formula-content');
      const toggleText = document.getElementById('toggle-text');
      const iconExpand = document.getElementById('icon-expand');
      const iconCollapse = document.getElementById('icon-collapse');
      
      if (formulaSection) {
        formulaSection.scrollIntoView({ behavior: 'smooth', block: 'start' });
        
        if (formulaContent?.classList.contains('hidden')) {
          formulaContent.classList.remove('hidden');
          iconExpand?.classList.add('hidden');
          iconCollapse?.classList.remove('hidden');
          if (toggleText) toggleText.textContent = 'Sembunyikan Rumus';
        }
      }
    });
  });
</script>

