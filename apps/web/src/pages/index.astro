---

import Layout from '../layouts/Layout.astro';

import HeroSection from '../components/hero/HeroSection.astro';

import SheetsInput from '../components/input/SheetsInput.astro';
import StudentInput from '../components/input/StudentInput.astro';
import DudiInput from '../components/input/DudiInput.astro';

import WeightsConfig from '../components/process/WeightsConfig.astro';
import ProcessButton from '../components/process/ProcessButton.astro';

import Validation from '../components/validation/Validation.astro';

import StatsCards from '../components/results/StatsCards.astro';
import ResultsTable from '../components/results/ResultsTable.astro';
import Charts from '../components/results/Charts.astro';
import Narrative from '../components/results/Narrative.astro';
import FormulaDetail from '../components/results/FormulaDetail.astro';
import Disqualified from '../components/results/Disqualified.astro';

import SummaryButton from '../components/preview/SummaryButton.astro';
import SummaryModal from '../components/preview/SummaryModal.astro';
---

<Layout title="SPK VIKOR - Sistem Pemilihan Tempat Magang">
  <HeroSection />

  <section class="section">
    <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8">
      <div class="mb-8">
        <div class="flex border-b border-secondary-200 mb-6">
          <button class="input-method-tab active" data-method="sheets">
            <svg class="w-4 h-4" fill="none" stroke="currentColor" viewBox="0 0 24 24">
              <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 17v-2m3 2v-4m3 4v-6m2 10H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 01.707.293l5.414 5.414a1 1 0 01.293.707V19a2 2 0 01-2 2z" />
            </svg>
            Google Sheets
          </button>
          <button class="input-method-tab" data-method="manual">
            <svg class="w-4 h-4" fill="none" stroke="currentColor" viewBox="0 0 24 24">
              <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M4 16v1a3 3 0 003 3h10a3 3 0 003-3v-1m-4-8l-4-4m0 0L8 8m4-4v12" />
            </svg>
            Upload Manual
          </button>
        </div>
        
        <div id="input-method-sheets" class="input-method-content">
          <SheetsInput />
        </div>
        
        <div id="input-method-manual" class="input-method-content hidden">
          <Validation />
          
          <div class="grid lg:grid-cols-2 gap-8 mb-8">
            <StudentInput />
            <DudiInput />
          </div>
        </div>
      </div>

      <WeightsConfig />

      <ProcessButton />

      <div id="results-section" class="hidden animate-fade-in">
        <StatsCards />
        <ResultsTable />
        <Charts />
        <Narrative />
        <FormulaDetail />
        <Disqualified />
        
        <SummaryButton />
      </div>
      
    </div>
  </section>
  
  <SummaryModal />
</Layout>

<script>
  document.addEventListener('DOMContentLoaded', () => {
    const tabs = document.querySelectorAll('.input-method-tab');
    
    tabs.forEach(tab => {
      tab.addEventListener('click', (e) => {
        const target = e.currentTarget as HTMLElement;
        const method = target.dataset.method;
        
        // Update tab styles
        tabs.forEach(t => t.classList.remove('active'));
        target.classList.add('active');
        
        document.querySelectorAll('.input-method-content').forEach(c => c.classList.add('hidden'));
        document.getElementById(`input-method-${method}`)?.classList.remove('hidden');
      });
    });
  });
</script>

<style>
  .input-method-tab {
    @apply flex items-center gap-2 px-4 py-3 text-sm font-medium text-secondary-500 border-b-2 border-transparent hover:text-primary-600 hover:border-primary-300 transition-colors;
  }
  
  .input-method-tab.active {
    @apply text-primary-700 border-primary-600;
  }
</style>

<script src="../scripts/app.js"></script>

